More functions, more netsred loops
